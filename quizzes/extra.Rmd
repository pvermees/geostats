---
title: "Additional exercises"
output:
  pdf_document:
    number_sections: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(include=TRUE, echo=TRUE)
solution <- FALSE
# to render:
# rmarkdown::render("~/Documents/Programming/R/geostats/quizzes/extra.Rmd","pdf_document")
```

# Brownian motion

Write a function that simulates a random walk:

1. From a starting position of $x=0$ and $y=0$, move a virtual
particle by a distance of 1 in a random direction.

2. Repeat $n=250$ times and plot the track of the particle as a line.

```{r brown, include=solution, out.width="50%", out.height="50%", fig.width=5, fig.height=5}
# brownian motion for one particle:
brown <- function(xy0=rep(0,2),n=250){
  xy <- matrix(rep(xy0,n),ncol=2,byrow=TRUE)
  d <- runif(n,min=0,max=2*pi) # random directions
  for (i in 2:n){
    dx <- cos(d[i])
    dy <- sin(d[i])
    xy[i,1] <- xy[i-1,1] + dx
    xy[i,2] <- xy[i-1,2] + dy
  }
  return(xy)
}
xy <- brown()
plot(xy,type='l',xlab='x',ylab='y')
```

3. Repeat steps 1 and 2 for $N=500$ virtual particles and visualise
their final positions on a scatter plot.

```{r browngauss, include=solution, out.width="50%", out.height="50%", fig.width=5, fig.height=5, include=solution}
n <- 250
N <- 500
xyf <- matrix(NA,nrow=N,ncol=2)
for (i in 1:N){
  xyf[i,] <- brown(n=n)[n,]
}
plot(xyf,type='p',pch=16,xlab='x',ylab='y')
```

# Diffusion

Using the code from the previous exercise:

1. Repeat step 3 for $n=250$, 500, 750 and 1000 iterations and
visualise the final positions on a ${2}\times{2}$ panel grid of
scatter plots. Adjust the axis limits so that all four panels are
plotted at the same scale.

```{r diffusion, include=solution, out.width="50%", out.height="50%", fig.width=5, fig.height=5, include=solution}

```

2. Plot the marginal distributions of the $x$-values as histograms,
kernel density estimates and empirical cumulative distribution
functions.

3. Visualise the bivariate datasets as 2-dimensional KDEs.

# Summary statistics

