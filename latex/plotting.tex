\chapter{Plotting data}
\label{ch:plotting}

A picture says more than a thousand words and nowhere is this more
true than in statistics. So before we explore the more quantitative
aspects of data analysis, it is useful to \emph{visualise} the data.
Consider, for example, the following four bivariate datasets
(Anscombe's quartet\footnote{Anscombe, F.J., 1973. Graphs in
  statistical analysis. \emph{The American statistician}, 27(1),
  pp.17-21.}):\medskip

\noindent\begin{minipage}[t][][b]{.6\textwidth}
  \begin{tabular}{cc|cc|cc|cc}
    \multicolumn{2}{c}{I} & \multicolumn{2}{c}{II} &
    \multicolumn{2}{c}{III} & \multicolumn{2}{c}{IV} \\
    $x$ & $y$ & $x$ & $y$ & $x$ & $y$ & $x$ & $y$ \\ \hline
    10.0 & 8.04 & 10.0 & 9.14 & 10.0 & 7.46 & 8.0 & 6.58 \\
    8.0 & 6.95 & 8.0 & 8.14 & 8.0 & 6.77 & 8.0 & 5.76 \\
    13.0 & 7.58 & 13.0 & 8.74 & 13.0 & 12.74 & 8.0 & 7.71 \\
    9.0 & 8.81 & 9.0 & 8.77 & 9.0 & 7.11 & 8.0 & 8.84 \\
    11.0 & 8.33 & 11.0 & 9.26 & 11.0 & 7.81 & 8.0 & 8.47 \\
    14.0 & 9.96 & 14.0 & 8.10 & 14.0 & 8.84 & 8.0 & 7.04 \\
    6.0 & 7.24 & 6.0 & 6.13 & 6.0 & 6.08 & 8.0 & 5.25 \\
    4.0 & 4.26 & 4.0 & 3.10 & 4.0 & 5.39 & 19.0 & 12.50 \\
    12.0 & 10.84 & 12.0 & 9.13 & 12.0 & 8.15 & 8.0 & 5.56 \\
    7.0 & 4.82 & 7.0 & 7.26 & 7.0 & 6.42 & 8.0 & 7.91 \\
    5.0 & 5.68 & 5.0 & 4.74 & 5.0 & 5.73 & 8.0 & 6.89 \\
  \end{tabular}
\end{minipage}
\begin{minipage}[t][][t]{.4\textwidth}
  \captionof{table}{Anscombe's quartet of bivariate data pairs.}
  \label{tab:anscombe}
\end{minipage}\medskip

For all four datasets (I -- IV):

\begin{itemize}\label{pg:anscombe}
\item the mean (see Chapter~\ref{ch:summary-statistics}) of $x$ is 9
\item the variance (see Chapter~\ref{ch:summary-statistics}) of $x$ is 11
\item the mean of $y$ is 7.50
\item the variance of $y$ is 4.125
\item the correlation coefficient (see Chapter~\ref{ch:regression})
  between $x$ and $y$ is 0.816
\item the best fit line (see Chapter~\ref{ch:regression}) is given by $y =
  3.00 + 0.500 x$
\end{itemize}

So at the summary level, it would appear that all four datasets are
identical. However, when we visualise the data as bivariate scatter
plots, they turn out to be very different:\medskip

\noindent\includegraphics[width=\textwidth]{../figures/anscombe.pdf}
\begingroup
\captionof{figure}{Anscombe's quartet shown as bivariate scatter
  plots.\medskip}\label{fig:anscombe}
\endgroup

Bivariate scatter plots are just one way to visualise analytical data.
Many other graphical devices exist, each of which is appropriate for a
particular type of data. The following section of this chapter will
introduce a number of these data types, and the associated plots.

\section{Data types}
\label{sec:datatypes}

Consider the following data table, which reports six different
properties of twenty fictitious river catchments:

\noindent\begin{minipage}[t][][b]{.55\linewidth}
\begin{tabular}{c|l@{\gap}l@{\gap}c@{\gap}c@{\gap}c@{\gap}c}
\# & lithology & age & springs & pH & Ca/Mg & vegetation \\ \hline
1 & basalt & Cz & 0 & 6.2 & 0.35 & 5.8 \\
2 & granite & Mz & 1 & 4.4 & 11.00 & 28 \\
3 & basalt & Mz & 0 & 5.6 & 6.00 & 12 \\
4 & sandstone & Cz & 6 & 5.2 & 1.80 & 27 \\
5 & shale & pC & 3 & 4.5 & 2.30 & 40 \\
6 & basalt & Mz & 1 & 5.4 & 0.59 & 12 \\
7 & shale & Pz & 2 & 4.8 & 8.40 & 3.8 \\
8 & basalt & Pz & 0 & 5.9 & 2.90 & 6.3 \\
9 & shale & Mz & 1 & 3.8 & 5.90 & 17 \\
10 & shale & Mz & 2 & 4.0 & 2.10 & 16 \\
11 & sandstone & Pz & 4 & 5.0 & 1.20 & 95 \\
12 & shale & pC & 2 & 4.1 & 2.10 & 94 \\
13 & sandstone & Mz & 4 & 5.2 & 1.10 & 92 \\
14 & basalt & Cz & 1 & 5.5 & 1.60 & 88 \\
15 & sandstone & Pz & 4 & 5.3 & 0.90 & 88 \\
16 & granite & Pz & 0 & 4.6 & 1.70 & 70 \\
17 & basalt & Mz & 0 & 5.7 & 3.40 & 92 \\
18 & shale & Pz & 1 & 4.6 & 0.53 & 72 \\
19 & granite & Mz & 0 & 4.6 & 2.20 & 74 \\
20 & basalt & Cz & 1 & 5.6 & 7.70 & 84 \\
\end{tabular}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.45\linewidth}
\captionof{table}{Twenty imaginary river catchments have been analysed
  for six different types of data: the lithology of the underlying
  bedrock and its stratigraphic age (where `Cz' is Cenozoic, `Mz' is
  Mesozoic, `Pz' is Palaeozoic, and `pC' is Precambrian); the number
  of natural springs in the catchments; the pH of the river water; its
  Ca/Mg ratio; and the percentage of the catchment area that is
  covered by vegetation.\medskip}
\label{tab:catchments}
\end{minipage}\medskip

The first three columns contain \textbf{discrete data} values and can
be visualised as bar charts or histograms.

\begin{enumerate}

\item\textbf{Categorical} data take on a limited number of values,
  assigning each `object' to a particular \emph{unordered} class or
  category. Geological examples of categorical data include animal
  species in a bone bed; the modal composition of a thin section; and
  lithologies in a mapping area (Figure~\ref{fig:discrete}.a).

\item\textbf{Ordinal} data are a special type of categorical data, in
  which the classes are \emph{ordered} but the distances between them
  are either irregular or unknown. Geological examples of ordinal
  quantities include Moh's hardness scale; metamorphic grade; and the
  geologic timescale (Figure~\ref{fig:discrete}.b).

\item\textbf{Count} data are a special type of ordinal data in which
  the categories are evenly spaced into integer intervals. Geological
  examples of count data include the number of gold chips found in a
  panning session; the annual number of earthquakes that exceed a
  certain magnitude; the number of dry wells in a wildcat drilling
  survey; and the number of natural springs in a river catchment
  (Figure~\ref{fig:discrete}.c).

\end{enumerate}

\noindent\includegraphics[width=\textwidth]{../figures/discrete.pdf}\medskip
\begingroup \captionof{figure}{Examples of discrete datasets, shown as
  bar charts. a) Categorical dataset of the dominant lithologies in 20
  river catchments. The order of the categories along the horizontal
  axis is completely arbitrary and can be changed without loss of
  information. b) Ordinal dataset summarising the stratigraphic age of
  the catchments, as defined in the caption of
  Table~\ref{tab:catchments}. The five categories are listed in
  chronological order, but span vastly different lengths of time; c)
  The number of natural springs per catchment.\medskip}
\label{fig:discrete}
\endgroup

Not all geological or geophysical measurements take on discrete
values.  Many are free to take on decimal values. We can also
subdivide these \textbf{continuous data} into further classes:

\begin{enumerate}
  \setcounter{enumi}{3}
\item\textbf{Cartesian quantities}\footnote{The terms Cartesian and
Jeffreys quantities were coined by Mosegaard and Tarantola (2002,
doi:10.1016/S0074-6142(02)80219-4), in honour of French mathematician
Ren\'{e} Descartes and British geophysicist Sir Harold Jeffreys. They
are also referred to as balances and amounts, respectively, by
Mosteller and Tukey (1977, ISBN:0-201-04854-X).\label{ftn:Tarantola}}
  can have any decimal value, including positive and negative
  ones. Geoscientific examples of this data type include the magnitude
  of earthquakes; the spontaneous electrical potential between
  geological strata; or the pH of aqueous solutions
  (Figure~\ref{fig:continuous}.a).
  
\item\textbf{Jeffreys quantities}\textsuperscript{\ref{ftn:Tarantola}}
  can only have positive values. Examples of this include mass,
  volume, density, speed, or the ratios of chemical concentrations
  (Figure~\ref{fig:continuous}.b).
  
\item\textbf{Proportions} are quantities that are constrained to a
  finite interval from 0 to 1 (or from 0 to 100\%). Examples of this
  include chemical concentrations; porosities; and volume or area
  fractions (Figure~\ref{fig:continuous}.c).
\end{enumerate}

\noindent\includegraphics[width=\textwidth]{../figures/continuous.pdf}\medskip
\begingroup \captionof{figure}{Three continuous datasets, shown as
  histograms, reporting the following properties of the 20 river
  catchments of Table~\ref{tab:catchments}: a) pH of the river water
  (free to take on positive and negative values); b) the Ca/Mg ratio
  of the water (non-negative numbers); and c) the proportion of the
  catchment area covered by vegetation (values between 0 and 100\%).}
\label{fig:continuous}
\endgroup

\section{Histograms}\label{sec:histogram}

Discrete (categorical, ordinal and count) data naturally fall into
bins and the most obvious way to visualise them is as bar charts
(Figure~\ref{fig:discrete}).  Likewise, continuous (Cartesian,
Jeffreys, proportions) data can also be collected into bins and
plotted as histograms (Figure~\ref{fig:continuous}). However, this
binning exercise poses two practical problems.

\begin{enumerate}

\item\textbf{How many bins should be used, and how wide should they be?}

  The number of bins strongly affects the appearance of a histogram.
  Figure~\ref{fig:binwidth} shows the pH data on two histograms with
  the individual measurements marked as vertical ticks
  underneath. This is also known as a \emph{rug plot}, and allows us
  to better assess the effect of bin width on the appearance of
  histograms:
  
  \noindent\begin{minipage}[t][][b]{.55\linewidth}
  \includegraphics[width=\textwidth]{../figures/binwidth.pdf}\medskip
  \end{minipage}
  \begin{minipage}[t][][t]{.45\linewidth}
    \captionof{figure}{Histogram a) uses a bin width of 1~pH unit
      whereas histogram b) uses a bin width of 0.5~pH units. The two
      histograms look considerably different and it is not immediately
      clear which choice of bin width is best.}
    \label{fig:binwidth}
  \end{minipage}

  A number of rules of thumb are available to choose the optimal number
  of bins. For example, \texttt{Excel} uses a simple square root rule:

  \begin{equation}
    \mbox{\#{bins} = } \lceil\sqrt{n}\rceil
  \end{equation}

  \noindent where $n$ is the number of observations (i.e. $n = 20$ for
  the pH example) and $\lceil\ast\rceil$ means the `ceiling' of
  $\ast$, i.e. the value rounded up to the next integer. \texttt{R}
  uses Sturges' Rule:

  \begin{equation}
    \mbox{\#{bins} = } \lceil\log_2[n] + 1\rceil
  \end{equation}

  \noindent however no rule of thumb is optimal in all situations.

\item\textbf{Where to place the bins?}

Even when the number of bins has been fixed, just shifting them
slightly to the left or to the right can have a significant effect on
the appearance of the histogram. For example:

\noindent\begin{minipage}[t][][b]{.55\linewidth}
  \includegraphics[width=\textwidth]{../figures/binpos.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.45\linewidth}
  \captionof{figure}{Two histograms of the pH data whose bin widths
    are the same, but whose bins have been offset by 0.25 pH units.
    This arbitrary decision strongly affects the appearance of the
    histogram.}
  \label{fig:binpos}
\end{minipage}

There is no optimal solution to the bin placement problem. This
reflects a limitation of histograms as a way to present continuous
data.

\end{enumerate}

\section{Kernel density estimation}\label{sec:KDE}

To overcome the bin placement problem, let us explore a variant of the
ordinary histogram that is constructed as follows:
\begin{enumerate}
\item Rank the measurements from low to high along a line.
\item Place a rectangular `box' on top of each measurement.
\item Stack the boxes to create one connected line.
\end{enumerate}
\noindent\begin{minipage}[t][][b]{.6\textwidth}
  \includegraphics[width=\textwidth]{../figures/rectKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.4\textwidth}
  \captionof{figure}{Construction of a stacked histogram of three data
    points, shown as a rug plot along the bottom axis. The rectangular
    `kernels' (with bandwidth $h$) shown in grey are centred around
    each of these data points. The black step function is obtained by
    taking the sum of these boxes. This procedure removes the need to
    choose bin locations.}
  \label{fig:rectangles}
\end{minipage}

Normalising the area under the resulting curve produces a so-called
Kernel Density Estimate (KDE). The mathematical definition of this
function is:

\begin{equation}
  \mbox{KDE}(x) = \frac{1}{nh} \sum\limits_{i=1}^{n} K\!\left(\frac{x-x_i}{h}\right)
  \label{eq:KDE}
\end{equation}

\noindent where $x_i$ is the $i$\textsuperscript{th} measurement (out
of $n$), $h$ is the `bandwidth' of the kernel density estimator ($h=1$
in Figure~\ref{fig:rectangles}), and $K(u)$ is the `kernel'
function. For the rectangular kernel:

\begin{equation}
  K(u) = 1/2 \mbox{~if~}|u| \leq 1, \mbox{~and~} K(u) = 0 \mbox{~otherwise}
\end{equation}

\noindent where `$|\ast|$' stands for ``the absolute value of
$\ast$''. Applying this method to the pH data:

\noindent\begin{minipage}[t][][b]{.3\textwidth}
  \includegraphics[width=\textwidth]{../figures/pHrectKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.7\textwidth}
  \captionof{figure}{Rectangular KDE of the pH data, constructed using
    the same procedure as shown in Figure~\ref{fig:rectangles}, but
    using a bandwidth $h=0.3276$. To turn the curve into a `density',
    the area under it has been normalised to unity.}
  \label{fig:pHrectKDE}
\end{minipage}

Instead of a rectangular kernel, we could also use triangles to
construct the KDE curve, or any other (symmetric) function. One
popular choice is the Gaussian function:

\begin{equation}
  K(u) = \frac{1}{\sqrt{2\pi}}\exp\!\left[-\frac{u^2}{2}\right]
  \label{eq:gaussiankernel}
\end{equation}

\noindent which produces a continuous KDE function:\medskip

\noindent\begin{minipage}[t][][b]{.3\textwidth}
  \includegraphics[width=\textwidth]{../figures/gaussKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.7\textwidth}
  \captionof{figure}{Using a Gaussian kernel instead of a rectangular
    kernel on the three data points of Figure~\ref{fig:rectangles},
    with bandwidth $h=1$. This produces a smooth KDE. The area under
    each of the kernels has been reduced to 1/3 so that the area under
    the KDE is 1.}
\end{minipage}

Using the Gaussian kernel to plot the pH data:\medskip

\noindent\begin{minipage}[t][][b]{.3\textwidth}
  \includegraphics[width=\textwidth]{../figures/pHgaussKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.7\textwidth}
  \captionof{figure}{Gaussian KDE of the pH data, with bandwidth
    $h=0.3276$. The continuous curve does more justice to the
    continuous data than the discrete step function of
    Figures~\ref{fig:binwidth}, \ref{fig:binpos} or
    \ref{fig:pHrectKDE}.}
  \label{fig:pHgaussKDE}
\end{minipage}

Although kernel density estimation solves the bin placement problem,
it is not entirely free of design decisions. The bandwidth $h$ of a
KDE fulfils a similar role as the bin width of a histogram. Changes in
$h$ affect the \emph{smoothness} of the KDE curve:\medskip

\noindent\begin{minipage}[t][][b]{.6\textwidth}
  \includegraphics[width=\textwidth]{../figures/bandwidth.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.4\textwidth}
  \captionof{figure}{KDEs of the pH data with a) a kernel bandwidth of
    $h=0.1$; and b) a bandwidth of $h=1$. Using a narrow bandwidth
    undermooths the data, whereas a wide bandwidth produces an
    oversmoothed distribution.}
\end{minipage}

Bandwidth selection is a similar problem to bin width selection.  A
deeper discussion of this problem falls outside the scope of text.
Suffice it to say that most statistical software (including
\texttt{R}) use equivalent rules of thumb to Sturges' Rule to set the
bandwidth.  But these values can be easily overruled by the user.

\section{Data transformations}
\label{sec:transformations}

As discussed in Section~\ref{sec:datatypes}, Jeffreys quantities such
as the Ca/Mg ratios of Figure~\ref{fig:continuous}.b exist within an
infinite half space between 0 and $+\infty$. However, when we
visualise them as a KDE, the left tail of this curve may extend into
negative data space, implying that there is a finite chance of
observing negative Ca/Mg ratios:

\noindent\begin{minipage}[t][][b]{.3\textwidth}
  \includegraphics[width=\textwidth]{../figures/negativeKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.7\textwidth}
  \captionof{figure}{KDE of 20 Ca/Mg ratio measurements.  Even though
    all the measurements are strictly positive, the curve extends into
    negative data space.\medskip}
  \label{fig:negativeKDE}
\end{minipage}

This problem can be solved by transforming the Jeffreys quantities to
the entire infinite space of numbers by applying a logarithmic
transformation:
\begin{equation}
  u = \ln[x]
\end{equation}

After constructing the KDE, the results can then be
mapped\footnote{The KDE values are adjusted so that $\mbox{KDE}(x) =
\mbox{KDE}(u)\frac{\partial{u}}{\partial{x}}$, which ensures that they
integrate to 1.} back to linear space using an exponential
transformation:
\begin{equation}
  x = \exp[u]
\end{equation}

\noindent\begin{minipage}[t][][b]{.6\textwidth}
  \includegraphics[width=\textwidth]{../figures/logKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.4\textwidth}
  \captionof{figure}{a) KDE of the Ca/Mg ratio measurements, after
    applying a logarithmic transformation.  Note how the distribution
    has become more symmetric compared to the linear scale of
    Figure~\ref{fig:negativeKDE}. b) The same KDE mapped back to the
    linear scale. Unlike Figure~\ref{fig:negativeKDE}, the mapped
    distribution does not cross over into negative values. \medskip}
  \label{fig:logKDE}
\end{minipage}

Jeffreys quantities are just one example of constrained measurements.
As another example, consider the vegetation data of
Figure~\ref{fig:continuous}.c. Again, the Gaussian KDE of the data
plots into physically impossible values of $<0$ and $>100\%$:\medskip

\noindent\begin{minipage}[t][][b]{.3\textwidth}
  \includegraphics[width=\textwidth]{../figures/vegetationKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.7\textwidth}
  \captionof{figure}{KDE of 20 vegetation measurements.  Even though
    all the measurements are between 0 and 100\%, the KDE extends
    beyond these hard limits.\medskip}
  \label{fig:vegetationKDE}
\end{minipage}

Using a similar approach as before, the dataspace can be opened up
from the constraints of the 0 to 1 interval to the entire line of
numbers, from $-\infty$ to $+\infty$. For proportions, this is
achieved by the \emph{logistic transformation}:

\begin{equation}
  u = \mbox{logit}(x) = \ln\!\left[\frac{x}{1-x}\right]
  \label{eq:logit}
\end{equation}

After constructing the density estimate (or carrying out any other
numerical manipulation), the results can be mapped back to the 0 to 1
interval with the inverse logit transformation:

\begin{equation}
  x = \mbox{logit}^{-1}(u) = \frac{\exp[u]}{\exp[u]+1}
  \label{eq:invlogit}
\end{equation}

\noindent\begin{minipage}[t][][b]{.6\textwidth}
  \includegraphics[width=\textwidth]{../figures/logitKDE.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.4\textwidth}
  \captionof{figure}{a) KDE of the vegetation data, after applying a
    logistic transformation.  Note the two horizonal axes.  The top
    axis marks the transformed values on a linear scale that extends
    from $-\infty$ to $+\infty$. The bottom axis is labelled by the
    actual vegetation values on a non-linear scale that extends from 0
    to 100\%. b) The same distribution mapped back to the 0 -- 100\%
    interval.\medskip}
  \label{fig:logitKDE}
\end{minipage}

We will see in Chapter~\ref{ch:compositional} that the logistic
transformation is a special case of a general class of \emph{logratio
  transformations} that are useful for the analysis of
\emph{compositional data}.

\section{Multivariate distributions}
\label{sec:multivariate}

KDEs can be generalised from one to two dimensions.  For example,
consider a dataset of eruption timings from the Old Faithful geyser in
Yellowstone national park (Wyoming, USA): \medskip

\noindent\begin{minipage}[t][][b]{.5\textwidth}
  \includegraphics[width=\textwidth]{../figures/KDE2D.pdf}\medskip
\end{minipage}
\begin{minipage}[t][][t]{.5\textwidth}
  \captionof{figure}{Old Faithful eruption measurements. The dataset
    records 272 observations of 2 variables: the duration of each
    eruption, and the waiting time between them. Both variables are
    expressed in minutes. The lower left panel shows the bivariate
    measurements as grey circles. The contour lines represent a
    2-dimensional KDE. The marginal distributions of the waiting times
    (top) and eruption durations (right) are shown as 1-dimensional
    KDEs.}
  \label{fig:KDE2D}
\end{minipage}

It is generally not possible to visualise datasets of more than two
dimensions in a single graphic. In this case there are two options:

\begin{enumerate}
  \item plot the data as a series of 1- or 2-dimensional marginal
    plots; or
  \item extract the most important patterns or trends in the data by
    projection onto a lower dimensional plane. Then show these
    projected data as a lower dimensional graphic.
\end{enumerate}

The second strategy is also known as ``ordination'' and will be
discussed in detail in Section~\ref{sec:PCA}.

\section{Empirical cumulative distribution functions}
\label{sec:ECDF}

Both histograms and kernel density estimates require the selection of
a `smoothing parameter'. For the histogram, this is the bin width; for
the KDE, it is the bandwidth ($h$ in Equation~\ref{eq:KDE}). Despite
the existence of rules of thumb to automatically choose an appropriate
value for the smoothing parameter, there nevertheless is a level of
arbitrariness associated with them. The empirical cumulative
distribution function (ECDF) is an alternative data visualisation
device that does not require smoothing. An ECDF is step function that
jumps up by $1/n$ at each of $n$ data points.  The mathematical
formula for this procedure can be written as:
  
  \begin{equation}
    F(x) = \sum\limits_{i=1}^{n} I(x_i<x)/n
    \label{eq:ECDF}
  \end{equation}
 
\noindent where $I(\ast) = 1$ if $\ast$ is `true' and $I(\ast) = 0$ if
$\ast$ is `false'. The y-coordinates of the ECDF are values from 0 to
1 that mark the fraction of the measurements that are less than a
particular value.  Plotting the pH, Ca/Mg, vegetation and geyser data
as ECDFs:

\noindent\includegraphics[width=\textwidth]{../figures/ECDFs.pdf}
\begingroup \captionof{figure}{Empirical cumulative distribution
  functions (ECDFs) of, from left to right: a) the pH data (whose KDE
  is shown in Figure~\ref{fig:pHgaussKDE}); b) the Ca/Mg ratios of
  Figure~\ref{fig:negativeKDE}; c) the vegetation data of
  Figure~\ref{fig:vegetationKDE}; and d) the eruption time data of
  Figure~\ref{fig:KDE2D}. Note that ECDFs are only applicable to
  1-dimensional datasets.\medskip}
\label{fig:ECDFs}
\endgroup

ECDFs do not require binning or selecting a bandwidth.  Because they
do not require smoothing, they do not spill over into physically
impossible values for the Ca/Mg and vegetation data. The ECDF is
completely determined by the raw data.\medskip

The visual interpretation of ECDFs is different from that of
histograms or KDEs. Whereas different clusters of values stand out as
`peaks' in a histogram or KDE, they are marked by steep segments of
the ECDF. For example, the two peaks in the KDE of the geyser data
(Figure~\ref{fig:KDE2D}) correspond to two steps in the ECDF
(Figure~\ref{fig:ECDFs}.d).
